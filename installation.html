<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Installing PyOP2 &mdash; PyOP2 0.11.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.11.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PyOP2 0.11.0 documentation" href="index.html" />
    <link rel="next" title="PyOP2 Concepts" href="concepts.html" />
    <link rel="prev" title="Welcome to PyOP2’s documentation!" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="concepts.html" title="PyOP2 Concepts"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to PyOP2’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PyOP2 0.11.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <a class="reference external image-reference" href="https://travis-ci.org/OP2/PyOP2"><img alt="build status" src="https://travis-ci.org/OP2/PyOP2.png?branch=master" /></a>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#installing-pyop2" id="id2">Installing PyOP2</a><ul>
<li><a class="reference internal" href="#quick-start-installations" id="id3">Quick start installations</a><ul>
<li><a class="reference internal" href="#installation-script-for-ubuntu" id="id4">Installation script for Ubuntu</a></li>
<li><a class="reference internal" href="#provisioning-a-virtual-machine" id="id5">Provisioning a virtual machine</a></li>
</ul>
</li>
<li><a class="reference internal" href="#manual-installation" id="id6">Manual Installation</a><ul>
<li><a class="reference internal" href="#dependencies" id="id7">Dependencies</a></li>
<li><a class="reference internal" href="#installing-packages-with-pip" id="id8">Installing packages with pip</a></li>
<li><a class="reference internal" href="#obtaining-a-build-environment-on-ubuntu-and-similar-systems" id="id9">Obtaining a build environment on Ubuntu and similar systems</a></li>
<li><a class="reference internal" href="#obtaining-a-build-environment-on-mac-os" id="id10">Obtaining a build environment on Mac OS</a></li>
<li><a class="reference internal" href="#petsc" id="id11">PETSc</a></li>
<li><a class="reference internal" href="#cuda-backend" id="id12">CUDA backend:</a></li>
<li><a class="reference internal" href="#opencl-backend" id="id13">OpenCL backend:</a></li>
<li><a class="reference internal" href="#hdf5" id="id14">HDF5</a></li>
</ul>
</li>
<li><a class="reference internal" href="#building-pyop2" id="id15">Building PyOP2</a></li>
<li><a class="reference internal" href="#setting-up-the-environment" id="id16">Setting up the environment</a></li>
<li><a class="reference internal" href="#testing-your-installation" id="id17">Testing your installation</a></li>
<li><a class="reference internal" href="#troubleshooting" id="id18">Troubleshooting</a><ul>
<li><a class="reference internal" href="#troubleshooting-test-failures" id="id19">Troubleshooting test failures</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="installing-pyop2">
<h1><a class="toc-backref" href="#id2">Installing PyOP2</a><a class="headerlink" href="#installing-pyop2" title="Permalink to this headline">¶</a></h1>
<p>The main testing platform for PyOP2 is Ubuntu 12.04 64-bit with Python
2.7.3. Other UNIX-like systems may or may not work. Mac OS X 10.7 and
10.9 are also known to work. Microsoft Windows may work, but is not a
supported platform.</p>
<div class="section" id="quick-start-installations">
<h2><a class="toc-backref" href="#id3">Quick start installations</a><a class="headerlink" href="#quick-start-installations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="installation-script-for-ubuntu">
<h3><a class="toc-backref" href="#id4">Installation script for Ubuntu</a><a class="headerlink" href="#installation-script-for-ubuntu" title="Permalink to this headline">¶</a></h3>
<p>For the impatient there is a script for the unattended installation of
PyOP2 and its dependencies on a Ubuntu 12.04 or compatible platform.
Only the sequential and OpenMP backends are covered at the moment.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This script will only work reliably on a clean Ubuntu installation and is
not intended to be used by PyOP2 developers. If you intend to contribute to
PyOP2 it is recommended to follow the instructions below for a manual
installation.</p>
</div>
<p>Running with superuser privileges will install missing packages and
Python dependencies will be installed system wide:</p>
<div class="highlight-python"><div class="highlight"><pre>wget -O - https://github.com/OP2/PyOP2/raw/master/install.sh | sudo bash
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>This will fail if you if you require a password for <tt class="docutils literal"><span class="pre">sudo</span></tt>. Run e.g. the
following beforehand to assure your password is cached</p>
<div class="last highlight-python"><div class="highlight"><pre>sudo whoami
</pre></div>
</div>
</div>
<p>Running without superuser privileges will instruct you which packages
need to be installed. Python dependencies will be installed to the user
site <tt class="docutils literal"><span class="pre">~/.local</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>wget -O - https://github.com/OP2/PyOP2/raw/master/install.sh | bash
</pre></div>
</div>
<p>In each case, PyOP2 will be cloned to subdirectories of the current directory.</p>
<p>After installation has completed and a rudimentary functionality check,
the test suite is run. The script indicates whether all these steps have
completed successfully and only in this case will exit with return code
0.</p>
<p>Only high-level progress updates are printed to screen. Most of the
output is redirected to a log file <tt class="docutils literal"><span class="pre">pyop2_install.log</span></tt>. Please consult
this log file in the case of errors. If you can&#8217;t figure out the cause
of discover a bug in the installation script, please <a class="reference external" href="https://github.com/OP2/PyOP2/issues">report
it</a>.</p>
<p>This completes the quick start installation. More complete
instructions follow for virtual machine and native installations.</p>
</div>
<div class="section" id="provisioning-a-virtual-machine">
<h3><a class="toc-backref" href="#id5">Provisioning a virtual machine</a><a class="headerlink" href="#provisioning-a-virtual-machine" title="Permalink to this headline">¶</a></h3>
<p>A <tt class="docutils literal"><span class="pre">Vagrantfile</span></tt> is provided for automatic provisioning of a Ubuntu
12.04 64bit virtual machine with PyOP2 preinstalled. It requires
<a class="reference external" href="https://www.virtualbox.org/wiki/Linux_Downloads">VirtualBox 4.2</a> and
<a class="reference external" href="http://www.vagrantup.com">Vagrant</a> to be installed, which are
available for Linux, Mac and Windows.</p>
<p>Creating and launching a virtual machine is a single command: run
<tt class="docutils literal"><span class="pre">vagrant</span> <span class="pre">up</span></tt> to automatically download the base VM image, configure it
for use with VirtualBox, boot the VM and install PyOP2 and all
dependencies using the above install script.</p>
</div>
</div>
<div class="section" id="manual-installation">
<h2><a class="toc-backref" href="#id6">Manual Installation</a><a class="headerlink" href="#manual-installation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dependencies">
<h3><a class="toc-backref" href="#id7">Dependencies</a><a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">You can skip over the dependencies list for now, since the
instructions below tell you how to install each of these packages.</p>
</div>
<p>PyOP2 requires a number of tools and libraries to be available:</p>
<ul class="simple">
<li>A C compiler (for example gcc or clang), make</li>
<li>A Fortran compiler (for PETSc)</li>
<li>MPI</li>
<li>Blas and Lapack</li>
<li>Git, Mercurial</li>
<li>pip and the Python headers</li>
</ul>
<p>The following dependencies are part of the Python
subsystem:</p>
<ul class="simple">
<li>Cython &gt;= 0.17</li>
<li>decorator</li>
<li>numpy &gt;= 1.6</li>
<li>networkx</li>
</ul>
<p>PETSc. We require very recent versions of PETSc so you will need to follow the specific instructions given below to install the right version.</p>
<ul class="simple">
<li><a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a></li>
<li><a class="reference external" href="http://pythonhosted.org/petsc4py/">PETSc4py</a></li>
</ul>
<p>Testing dependencies (optional, required to run the tests):</p>
<ul class="simple">
<li>pytest &gt;= 2.3</li>
<li>flake8 &gt;= 2.1.0</li>
<li>gmsh</li>
<li>triangle</li>
</ul>
<p>With the exception of the <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> dependencies, these can be installed
using the package management system of your OS, or via <tt class="docutils literal"><span class="pre">pip</span></tt>.</p>
</div>
<div class="section" id="installing-packages-with-pip">
<h3><a class="toc-backref" href="#id8">Installing packages with pip</a><a class="headerlink" href="#installing-packages-with-pip" title="Permalink to this headline">¶</a></h3>
<p>To install dependencies system-wide use <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">...</span></tt>, to
install to a user site use <tt class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--user</span> <span class="pre">...</span></tt>. If you don&#8217;t want
PyOP2 or its dependencies interfering with your existing Python environment,
consider creating a <a class="reference external" href="http://virtualenv.org/">virtualenv</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the following we will use <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">...</span></tt>. If
you want either of the other options you should change the command
appropriately.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Installing to the user site does not always give packages
priority over system installed packages on your <tt class="docutils literal"><span class="pre">sys.path</span></tt>.</p>
</div>
</div>
<div class="section" id="obtaining-a-build-environment-on-ubuntu-and-similar-systems">
<h3><a class="toc-backref" href="#id9">Obtaining a build environment on Ubuntu and similar systems</a><a class="headerlink" href="#obtaining-a-build-environment-on-ubuntu-and-similar-systems" title="Permalink to this headline">¶</a></h3>
<p>On a Debian-based system (Ubuntu, Mint, etc.) install core packages:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo apt-get install -y build-essential python-dev git-core \
  mercurial python-pip libopenmpi-dev openmpi-bin libblas-dev \
  liblapack-dev gfortran
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This may not give you recent enough versions of those packages
(in particular the Cython version shipped with 12.04 is too old). You
can selectively upgrade packages via <tt class="docutils literal"><span class="pre">pip</span></tt>, see below.</p>
</div>
<p>Install dependencies via <tt class="docutils literal"><span class="pre">pip</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo pip install &quot;Cython&gt;=0.17&quot; decorator &quot;numpy&gt;=1.6&quot; networkx
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If your OS release is very old and you are therefore using
Python 2.6 instead of 2.7, you need two additional dependencies.</p>
</div>
<p>Additional Python 2.6 dependencies:</p>
<ul class="simple">
<li>argparse</li>
<li>ordereddict</li>
</ul>
<p>Install these via <tt class="docutils literal"><span class="pre">pip</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo pip install argparse ordereddict
</pre></div>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">You can now skip down to installing <a class="reference internal" href="#petsc-install"><em>PETSc</em></a>.</p>
</div>
</div>
<div class="section" id="obtaining-a-build-environment-on-mac-os">
<span id="mac-install"></span><h3><a class="toc-backref" href="#id10">Obtaining a build environment on Mac OS</a><a class="headerlink" href="#obtaining-a-build-environment-on-mac-os" title="Permalink to this headline">¶</a></h3>
<p>We recommend using <a class="reference external" href="http://brew.sh">Homebrew</a> as a package manager
for the required packages on Mac OS systems.  Obtaining a build
environment for PyOP2 consists of the following:</p>
<ol class="arabic">
<li><p class="first">Install Xcode.  For OS X 10.9 (Mavericks) this is possible through
the App Store.  For earlier versions, try
<a class="reference external" href="https://developer.apple.com/downloads">https://developer.apple.com/downloads</a> (note that on OS X 10.7
(Lion) you will need to obtain Xcode 4.6 rather than Xcode 5)</p>
</li>
<li><p class="first">If you did not install Xcode 5, you will need to additionally
install the Xcode command line tools through the downloads section
of Xcode&#8217;s preferences</p>
</li>
<li><p class="first">Install homebrew, following the instructions at <a class="reference external" href="http://brew.sh">http://brew.sh</a></p>
</li>
<li><p class="first">Install an MPI library (PyOP2 is tested with openmpi):</p>
<div class="highlight-python"><div class="highlight"><pre>brew install openmpi
</pre></div>
</div>
</li>
<li><p class="first">Install an up-to-date Python via homebrew:</p>
<div class="highlight-python"><div class="highlight"><pre>brew install python
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not follow the instructions to update pip, since they
currently result in a broken pip installation (see
<a class="reference external" href="https://github.com/Homebrew/homebrew/issues/26900">https://github.com/Homebrew/homebrew/issues/26900</a>)</p>
</div>
</li>
<li><p class="first">Install numpy via homebrew:</p>
<div class="highlight-python"><div class="highlight"><pre>brew tap homebrew/python
brew install numpy
</pre></div>
</div>
</li>
<li><p class="first">Install python dependencies via pip:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install decorator
pip install cython
pip install mpi4py
pip install pytest
pip install flake8
</pre></div>
</div>
</li>
</ol>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Your system is now ready to move on to installation of <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> and
<a class="reference external" href="http://pythonhosted.org/petsc4py/">petsc4py</a> described below.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">On Mac OS we do not recommend using sudo when installing, as such
when following instructions below to install with pip just remove
the <tt class="docutils literal"><span class="pre">sudo</span></tt> portion of the command.</p>
</div>
</div>
<div class="section" id="petsc">
<span id="petsc-install"></span><h3><a class="toc-backref" href="#id11">PETSc</a><a class="headerlink" href="#petsc" title="Permalink to this headline">¶</a></h3>
<p>PyOP2 uses <a class="reference external" href="http://pythonhosted.org/petsc4py/">petsc4py</a>, the Python bindings for the <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> linear algebra
library and requires:</p>
<ul class="simple">
<li>an MPI implementation built with <em>shared libraries</em></li>
<li>A suitable very recent <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> master branch built with <em>shared libraries</em></li>
</ul>
<p>If you have a suitable <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> installed on your system, <tt class="docutils literal"><span class="pre">PETSC_DIR</span></tt>
and <tt class="docutils literal"><span class="pre">PETSC_ARCH</span></tt> need to be set for the <a class="reference external" href="http://pythonhosted.org/petsc4py/">petsc4py</a> installer to find
it.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are no current OS PETSc packages which are new
enough. Therefore, unless you really know you should be doing
otherwise, always install <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> using pip. The following
instructions will install the firedrake branch of <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> and
<a class="reference external" href="http://pythonhosted.org/petsc4py/">petsc4py</a>. This is a recent version of the upstream master branch
which has been verified to at least build correctly. You may also
use the upstream next or master branch, but be aware that these are
rapidly developing and tend to break regularly.</p>
</div>
<p>Then install <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> via <tt class="docutils literal"><span class="pre">pip</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre>sudo PETSC_CONFIGURE_OPTIONS=&quot;--download-ctetgen --download-triangle --download-chaco&quot; \
  pip install https://bitbucket.org/mapdes/petsc/get/firedrake.tar.bz2
unset PETSC_DIR
unset PETSC_ARCH
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you intend to run PyOP2&#8217;s OpenMP backend, you should
additionally pass the following options to the PETSc configure
stage</p>
<div class="last highlight-python"><div class="highlight"><pre>--with-threadcomm --with-openmp --with-pthreadclasses
</pre></div>
</div>
</div>
<p>If you built <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> using <tt class="docutils literal"><span class="pre">pip</span></tt>, <tt class="docutils literal"><span class="pre">PETSC_DIR</span></tt> and <tt class="docutils literal"><span class="pre">PETSC_ARCH</span></tt>
should be left unset when building <a class="reference external" href="http://pythonhosted.org/petsc4py/">petsc4py</a>.</p>
<p>Install <a class="reference external" href="http://pythonhosted.org/petsc4py/">petsc4py</a> via <tt class="docutils literal"><span class="pre">pip</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo pip install git+https://bitbucket.org/petsc/petsc4py.git@firedrake#egg=petsc4py
</pre></div>
</div>
<p>If you have previously installed and older version of <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> or <a class="reference external" href="http://pythonhosted.org/petsc4py/">petsc4py</a>,
<tt class="docutils literal"><span class="pre">pip</span></tt> might tell you that the requirements are already satisfied when running
above commands. In that case, use <tt class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-U</span> <span class="pre">--no-deps</span></tt> to upgrade
(<tt class="docutils literal"><span class="pre">--no-deps</span></tt> prevents also recursively upgrading any dependencies).</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">If you only intend to run PyOP2 on CPUs (not GPUs) you can now skip
straight to <a class="reference internal" href="#pyop2-install"><em>Building PyOP2</em></a>, otherwise read on for additional
dependencies.</p>
</div>
</div>
<div class="section" id="cuda-backend">
<span id="cuda-installation"></span><h3><a class="toc-backref" href="#id12">CUDA backend:</a><a class="headerlink" href="#cuda-backend" title="Permalink to this headline">¶</a></h3>
<p>Dependencies:</p>
<ul class="simple">
<li>boost-python</li>
<li>Cusp 0.3.1</li>
<li>codepy &gt;= 2013.1</li>
<li>Jinja2</li>
<li>mako</li>
<li>pycparser &gt;= 2.10</li>
<li>pycuda &gt;= 2013.1</li>
</ul>
<p>The <a class="reference external" href="http://cusplibrary.github.io">cusp library</a> version 0.3.1
headers need to be in your (CUDA) include path.</p>
<p><strong>Note:</strong> Using the trunk version of Cusp will <em>not</em> work, since
revision f525d61 introduces a change that break backwards compatibility
with CUDA 4.x.</p>
<p>Install dependencies via the package manager (Debian based systems):</p>
<div class="highlight-python"><div class="highlight"><pre>sudo apt-get install libboost-python-dev python-jinja2 python-mako python-pycuda
</pre></div>
</div>
<p><strong>Note:</strong> The version of pycparser available in the package repositories
is too old, you will need to install it via <tt class="docutils literal"><span class="pre">pip</span></tt>, see below.</p>
<p>Install dependencies via <tt class="docutils literal"><span class="pre">pip</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo pip install codepy Jinja2 mako pycparser&gt;=2.10
</pre></div>
</div>
<p>If a pycuda package is not available, it will be necessary to install it
manually. Make sure <tt class="docutils literal"><span class="pre">nvcc</span></tt> is in your <tt class="docutils literal"><span class="pre">$PATH</span></tt> and <tt class="docutils literal"><span class="pre">libcuda.so</span></tt> in
your <tt class="docutils literal"><span class="pre">$LIBRARY_PATH</span></tt> if in a non-standard location:</p>
<div class="highlight-python"><div class="highlight"><pre>export CUDA_ROOT=/usr/local/cuda # change as appropriate
git clone https://github.com/inducer/pycuda.git
cd pycuda
git submodule init
git submodule update
# libcuda.so is in a non-standard location on Ubuntu systems
./configure.py --no-use-shipped-boost \
--cudadrv-lib-dir=&quot;/usr/lib/nvidia-current,${CUDA_ROOT}/lib,${CUDA_ROOT}/lib64&quot;
python setup.py build
sudo python setup.py install
sudo cp siteconf.py /etc/aksetup-defaults.py
</pre></div>
</div>
</div>
<div class="section" id="opencl-backend">
<span id="opencl-installation"></span><h3><a class="toc-backref" href="#id13">OpenCL backend:</a><a class="headerlink" href="#opencl-backend" title="Permalink to this headline">¶</a></h3>
<p>Dependencies:</p>
<ul class="simple">
<li>Jinja2</li>
<li>mako</li>
<li>pycparser &gt;= 2.10</li>
<li>pyopencl &gt;= 2012.1</li>
</ul>
<p>pyopencl requires the OpenCL header <tt class="docutils literal"><span class="pre">CL/cl.h</span></tt> in a standard include
path. On a Debian system, install it via the package manager:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo apt-get install opencl-headers
</pre></div>
</div>
<p>If you want to use OpenCL headers and/or libraries from a non-standard
location you need to configure pyopencl manually:</p>
<div class="highlight-python"><div class="highlight"><pre>export OPENCL_ROOT=/usr/local/opencl # change as appropriate
git clone https://github.com/inducer/pyopencl.git
cd pyopencl
git submodule init
git submodule update
./configure.py --no-use-shipped-boost \
--cl-inc-dir=${OPENCL_ROOT}/include --cl-lib-dir=${OPENCL_ROOT}/lib
python setup.py build
sudo python setup.py install
</pre></div>
</div>
<p>Otherwise, install dependencies via <tt class="docutils literal"><span class="pre">pip</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo pip install Jinja2 mako pyopencl&gt;=2012.1 pycparser&gt;=2.10
</pre></div>
</div>
<p>Installing the Intel OpenCL toolkit (64bit systems only):</p>
<div class="highlight-python"><div class="highlight"><pre>cd /tmp
# install alien to convert the rpm to a deb package
sudo apt-get install alien
fakeroot wget http://registrationcenter.intel.com/irc_nas/2563/intel_sdk_for_ocl_applications_2012_x64.tgz
tar xzf intel_sdk_for_ocl_applications_2012_x64.tgz
fakeroot alien *.rpm
sudo dpkg -i --force-overwrite *.deb
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">--force-overwrite</span></tt> option is necessary in order to resolve
conflicts with the opencl-headers package (if installed).</p>
<p>Installing the <a class="reference external" href="http://developer.amd.com/tools/heterogeneous-computing/amd-accelerated-parallel-processing-app-sdk/">AMD OpenCL
toolkit</a>
(32bit and 64bit systems):</p>
<div class="highlight-python"><div class="highlight"><pre>wget http://developer.amd.com/wordpress/media/2012/11/AMD-APP-SDK-v2.8-lnx64.tgz
# on a 32bit system, instead
wget http://developer.amd.com/wordpress/media/2012/11/AMD-APP-SDK-v2.8-lnx32.tgz
tar xzf AMD-APP-SDK-v2.8-lnx*.tgz
# Install to /usr/local instead of /opt
sed -ie &#39;s:/opt:/usr/local:g&#39; default-install_lnx*.pl
sudo ./Install-AMD-APP.sh
</pre></div>
</div>
</div>
<div class="section" id="hdf5">
<h3><a class="toc-backref" href="#id14">HDF5</a><a class="headerlink" href="#hdf5" title="Permalink to this headline">¶</a></h3>
<p>PyOP2 allows initializing data structures using data stored in HDF5
files. To use this feature you need the optional dependency
<a class="reference external" href="http://h5py.org">h5py</a>.</p>
<p>On a Debian-based system, run:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo apt-get install libhdf5-mpi-dev python-h5py
</pre></div>
</div>
<p>Alternatively, if the HDF5 library is available, <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">h5py</span></tt>.</p>
</div>
</div>
<div class="section" id="building-pyop2">
<span id="pyop2-install"></span><h2><a class="toc-backref" href="#id15">Building PyOP2</a><a class="headerlink" href="#building-pyop2" title="Permalink to this headline">¶</a></h2>
<p>Clone the PyOP2 repository:</p>
<div class="highlight-python"><div class="highlight"><pre>git clone git://github.com/OP2/PyOP2.git
</pre></div>
</div>
<p>PyOP2 uses <a class="reference external" href="http://cython.org">Cython</a> extension modules, which need to be built
in-place when using PyOP2 from the source tree:</p>
<div class="highlight-python"><div class="highlight"><pre>python setup.py build_ext --inplace
</pre></div>
</div>
<p>When running PyOP2 from the source tree, make sure it is on your
<tt class="docutils literal"><span class="pre">$PYTHONPATH</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>export PYTHONPATH=/path/to/PyOP2:$PYTHONPATH
</pre></div>
</div>
<p>When installing PyOP2 via <tt class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></tt> the extension
modules will be built automatically and amending <tt class="docutils literal"><span class="pre">$PYTHONPATH</span></tt> is not
necessary.</p>
</div>
<div class="section" id="setting-up-the-environment">
<h2><a class="toc-backref" href="#id16">Setting up the environment</a><a class="headerlink" href="#setting-up-the-environment" title="Permalink to this headline">¶</a></h2>
<p>To make sure PyOP2 finds all its dependencies, create a file <tt class="docutils literal"><span class="pre">.env</span></tt>
e.g. in your PyOP2 root directory and source it via <tt class="docutils literal"><span class="pre">.</span> <span class="pre">.env</span></tt> when
using PyOP2. Use the template below, adjusting paths and removing
definitions as necessary:</p>
<div class="highlight-python"><div class="highlight"><pre>#PETSc installation, not necessary when PETSc was installed via pip
export PETSC_DIR=/path/to/petsc
export PETSC_ARCH=linux-gnu-c-opt

#Add PyOP2 to PYTHONPATH
export PYTHONPATH=/path/to/PyOP2:$PYTHONPATH
</pre></div>
</div>
<p>Alternatively, package the configuration in an <a class="reference external" href="http://modules.sourceforge.net/">environment
module</a>.</p>
</div>
<div class="section" id="testing-your-installation">
<h2><a class="toc-backref" href="#id17">Testing your installation</a><a class="headerlink" href="#testing-your-installation" title="Permalink to this headline">¶</a></h2>
<p>PyOP2 unit tests use <a class="reference external" href="http://pytest.org">pytest</a> &gt;= 2.3. Install via package
manager:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo apt-get install python-pytest
</pre></div>
</div>
<p>or pip:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo pip install &quot;pytest&gt;=2.3&quot;
</pre></div>
</div>
<p>The code linting test uses <a class="reference external" href="http://flake8.readthedocs.org">flake8</a>.
Install via pip:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo pip install &quot;flake8&gt;=2.1.0&quot;
</pre></div>
</div>
<p>If you install <em>pytest</em> and <em>flake8</em> using <tt class="docutils literal"><span class="pre">pip</span> <span class="pre">--user</span></tt>, you should
include the binary folder of your local site in your path by adding the
following to <tt class="docutils literal"><span class="pre">~/.bashrc</span></tt> or <tt class="docutils literal"><span class="pre">.env</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre># Add pytest binaries to the path
export PATH=${PATH}:${HOME}/.local/bin
</pre></div>
</div>
<p>If all tests in our test suite pass, you should be good to go:</p>
<div class="highlight-python"><div class="highlight"><pre>make test
</pre></div>
</div>
<p>This will run code linting and unit tests, attempting to run for all backends
and skipping those for not available backends.</p>
</div>
<div class="section" id="troubleshooting">
<h2><a class="toc-backref" href="#id18">Troubleshooting</a><a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>Start by verifying that PyOP2 picks up the &#8220;correct&#8221; dependencies, in
particular if you have several versions of a Python package installed in
different places on the system.</p>
<p>Run <tt class="docutils literal"><span class="pre">pydoc</span> <span class="pre">&lt;module&gt;</span></tt> to find out where a module/package is loaded
from. To print the module search path, run:</p>
<div class="highlight-python"><div class="highlight"><pre>python -c &#39;from pprint import pprint; import sys; pprint(sys.path)&#39;
</pre></div>
</div>
<div class="section" id="troubleshooting-test-failures">
<h3><a class="toc-backref" href="#id19">Troubleshooting test failures</a><a class="headerlink" href="#troubleshooting-test-failures" title="Permalink to this headline">¶</a></h3>
<p>Run the tests as follows, to abort after the first failed test:</p>
<p>Start with the unit tests with the sequential backend</p>
<div class="highlight-python"><div class="highlight"><pre>py.test test/unit -vsx --tb=short --backend=sequential
</pre></div>
</div>
<p>With all the sequential tests passing, move on to the next backend in the same
manner as required.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Installing PyOP2</a><ul>
<li><a class="reference internal" href="#quick-start-installations">Quick start installations</a><ul>
<li><a class="reference internal" href="#installation-script-for-ubuntu">Installation script for Ubuntu</a></li>
<li><a class="reference internal" href="#provisioning-a-virtual-machine">Provisioning a virtual machine</a></li>
</ul>
</li>
<li><a class="reference internal" href="#manual-installation">Manual Installation</a><ul>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#installing-packages-with-pip">Installing packages with pip</a></li>
<li><a class="reference internal" href="#obtaining-a-build-environment-on-ubuntu-and-similar-systems">Obtaining a build environment on Ubuntu and similar systems</a></li>
<li><a class="reference internal" href="#obtaining-a-build-environment-on-mac-os">Obtaining a build environment on Mac OS</a></li>
<li><a class="reference internal" href="#petsc">PETSc</a></li>
<li><a class="reference internal" href="#cuda-backend">CUDA backend:</a></li>
<li><a class="reference internal" href="#opencl-backend">OpenCL backend:</a></li>
<li><a class="reference internal" href="#hdf5">HDF5</a></li>
</ul>
</li>
<li><a class="reference internal" href="#building-pyop2">Building PyOP2</a></li>
<li><a class="reference internal" href="#setting-up-the-environment">Setting up the environment</a></li>
<li><a class="reference internal" href="#testing-your-installation">Testing your installation</a></li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li><a class="reference internal" href="#troubleshooting-test-failures">Troubleshooting test failures</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to PyOP2&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="concepts.html"
                        title="next chapter">PyOP2 Concepts</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/installation.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="concepts.html" title="PyOP2 Concepts"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to PyOP2’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">PyOP2 0.11.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012-2013, Imperial College et al.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3a0.
    </div>
  </body>
</html>